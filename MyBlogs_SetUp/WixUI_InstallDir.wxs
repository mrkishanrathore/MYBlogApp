<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

	<Fragment>
		<UI Id="CustomDlg_InstallDir">
			<TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
			<TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="12" />
			<TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" />

			<Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />

			<DialogRef Id="BrowseDlg" />
			<DialogRef Id="DiskCostDlg" />
			<DialogRef Id="ErrorDlg" />
			<DialogRef Id="FatalError" />
			<DialogRef Id="FilesInUse" />
			<DialogRef Id="MsiRMFilesInUse" />
			<DialogRef Id="PrepareDlg" />
			<DialogRef Id="ProgressDlg" />
			<DialogRef Id="ResumeDlg" />
			<DialogRef Id="UserExit" />

			<!-- Info Dialog for Http port and Connection string Validation Msg-->
			<Dialog Id="InfoDlg" Width="200" Height="150" Title="Info Dialog">
				<Control Id="Text" Type="Text" X="15" Y="15" Width="170" Height="30" Text="[VALIDATIONRESULT]" />
				<Control Id="CloseButton" Type="PushButton" X="70" Y="100" Width="60" Height="17" Default="yes" Text="Close">
					<Publish Event="NewDialog" Value="PortAndConnectionDlg" Order="1"></Publish>
				</Control>
			</Dialog>

			<!-- Info Dialog for Https port and Certificate File Validation Msg-->
			<Dialog Id="InfoDlg2" Width="200" Height="150" Title="Info Dialog">
				<Control Id="Text" Type="Text" X="15" Y="15" Width="170" Height="30" Text="[VALIDATIONRESULT2]" />
				<Control Id="CloseButton" Type="PushButton" X="70" Y="100" Width="60" Height="17" Default="yes" Text="Close">
					<Publish Event="NewDialog" Value="HttpsDlg" Order="1"></Publish>
				</Control>
			</Dialog>

			<!-- Dialog for Http Port and Connection String-->
			<Dialog Id="PortAndConnectionDlg" Width="370" Height="270" Title="MyBlogs Custom Installation Options">
				<Control Id="PathText" Type="Text" X="15" Y="15" Width="200" Height="15" Text="Connection String :" />
				<Control Id="PathEdit" Type="Edit" X="15" Y="30" Width="340" Height="18" Property="CONNECTIONSTRING" />
				
				<Control Id="PortText" Type="Text" X="15" Y="60" Width="200" Height="15" Text="Port Number :" />
				<Control Id="PortEdit" Type="Edit" X="15" Y="75" Width="340" Height="18" Property="HTTPPORT" />
				
				<Control Id="HostNameText" Type="Text" X="15" Y="105" Width="200" Height="15" Text="Host/Domain Name :" />
				<Control Id="HostNameEdit" Type="Edit" X="15" Y="120" Width="340" Height="18" Property="HOSTNAME" />
				
				<Control Id="ENABLE_HTTPS" Type="CheckBox" X="15" Y="150" Width="290" Height="18" Property="ENABLEHTTPS" CheckBoxValue="1" Text=" Enable HTTPS" />
				
				<Control Id="NoteText" Type="Text" X="15" Y="210" Width="340" Height="15" Text="Note: Please Check PORT and CONNECTION STRING before moving forward." />
				
				<Control Id="CheckPORTSQLCONNECTIONButton" Type="PushButton" X="245" Y="240" Width="56" Height="17" Text="Check"  Default="yes">
					<Publish Event="DoAction" Value="CheckPortSQLConnection"></Publish>
					<Publish Event="NewDialog" Value="InfoDlg" Order="1"></Publish>
				</Control>

				<Control Id="NextButton" Type="PushButton" X="305" Y="240" Width="56" Height="17" Text="Next" EnableCondition="VALIDATIONRESULT = &quot;Validation successful!&quot;"  Disabled="yes"></Control>
				<Control Id="BackButton" Type="PushButton" X="185" Y="240" Width="56" Height="17" Text="Back"></Control>
				<Control Id="CancelButton" Type="PushButton" X="125" Y="240" Width="56" Height="17" Text="Cancel">
					<Publish Event="EndDialog" Value="Exit"></Publish>
				</Control>
			</Dialog>


			<!-- Dialog for Https Port and Certificate Details -->
			<Dialog Id="HttpsDlg" Width="370" Height="270" Title="HTTPS Configuration">
				<Control Id="HTTPS_PORT_LABEL" Type="Text" X="15" Y="15" Width="290" Height="15" Text="HTTPS Port:" />
				<Control Id="HTTPS_PORT" Type="Edit" X="15" Y="30" Width="340" Height="18" Property="HTTPSPORT" Disabled="yes"/>

				<Control Id="CERT_LOC_LABEL" Type="Text" X="15" Y="55" Width="290" Height="15" Text="Certificate Location:" />
				<Control Id="CERT_LOC" Type="Edit" X="15" Y="70" Width="340" Height="18" Property="CERTPATH" />

				<Control Id="CERT_PASS_LABEL" Type="Text" X="15" Y="95" Width="290" Height="15" Text="Certificate Password:" />
				<Control Id="CERT_PASS" Type="Edit" X="15" Y="110" Width="340" Height="18" Property="CERTPASSWORD" Password="yes"/>

				<Control Id="CheckHTTPSPORT_File" Type="PushButton" X="245" Y="240" Width="56" Height="17" Text="Check"  Default="yes">
					<Publish Event="DoAction" Value="CheckHttpsPortCertLoc"></Publish>
					<Publish Event="NewDialog" Value="InfoDlg2" Order="1"></Publish>
				</Control>

				<Control Id="NextButton" Type="PushButton" X="305" Y="240" Width="56" Height="17" Text="Next" EnableCondition="VALIDATIONRESULT2 = &quot;success&quot;"  Disabled="yes">

				</Control>
				<Control Id="BackButton" Type="PushButton" X="185" Y="240" Width="56" Height="17" Text="Back">
					<!--<Publish Event="NewDialog" Value="WelcomeDlg"></Publish>-->
				</Control>
				<Control Id="CancelButton" Type="PushButton" X="125" Y="240" Width="56" Height="17" Text="Cancel">
					<Publish Event="EndDialog" Value="Exit"></Publish>
				</Control>
			</Dialog>



			<Publish Dialog="BrowseDlg" Control="OK" Event="SpawnDialog" Value="InvalidDirDlg" Order="4"/>
			<Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="999" />
			<Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="PortAndConnectionDlg" />

			<!-- Define Dialog Navigation for PortAndConnectionDlg-->
			<Publish Dialog="PortAndConnectionDlg" Control="BackButton" Event="NewDialog" Value="WelcomeDlg" Order="1"/>
			<Publish Dialog="PortAndConnectionDlg" Control="NextButton" Event="NewDialog" Value="HttpsDlg" Order="1" Condition="ENABLEHTTPS=1"></Publish>
			<Publish Dialog="PortAndConnectionDlg" Control="NextButton" Event="NewDialog" Value="LicenseAgreementDlg" Order="2" Condition="NOT ENABLEHTTPS"></Publish>

			<!-- Define Dialog for HttpsDlg -->
			<Publish Dialog="HttpsDlg" Control="BackButton" Event="NewDialog" Value="PortAndConnectionDlg" />
			<Publish Dialog="HttpsDlg" Control="NextButton" Event="NewDialog" Value="LicenseAgreementDlg" />

			<Publish Dialog="LicenseAgreementDlg" Control="Back" Event="NewDialog" Value="HttpsDlg" Condition="ENABLEHTTPS=1"/>
			<Publish Dialog="LicenseAgreementDlg" Control="Back" Event="NewDialog" Value="PortAndConnectionDlg"  Condition="NOT ENABLEHTTPS"/>
			<Publish Dialog="LicenseAgreementDlg" Control="Print" Event="DoAction" Value="PrintLicense" />
			<Publish Dialog="LicenseAgreementDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg"/>
			<Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="LicenseAgreementDlg" Order="1"/>
			<Publish Dialog="MaintenanceWelcomeDlg" Control="Next" Event="NewDialog" Value="MaintenanceTypeDlg" />
			<Publish Dialog="MaintenanceTypeDlg" Control="RepairButton" Event="NewDialog" Value="VerifyReadyDlg" />
			<Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Event="NewDialog" Value="VerifyReadyDlg" />
			<Publish Dialog="MaintenanceTypeDlg" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg" />
			
			<Property Id="ARPNOMODIFY" Value="1" />
		</UI>

		<UIRef Id="WixUI_Common" />
	</Fragment>
</Wix>
